<?xml version="1.0"?>
<!--
     - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
     - Kerneos
     - Copyright (C) 2011 Bull S.A.S.
     - Contact: jasmine AT ow2.org
     -
     - This library is free software; you can redistribute it and/or
     - modify it under the terms of the GNU Lesser General Public
     - License as published by the Free Software Foundation; either
     - version 2.1 of the License, or any later version.
     -
     - This library is distributed in the hope that it will be useful,
     - but WITHOUT ANY WARRANTY; without even the implied warranty of
     - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
     - Lesser General Public License for more details.
     -
     - You should have received a copy of the GNU Lesser General Public
     - License along with this library; if not, write to the Free Software
     - Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307
     - USA
     -
     - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
-->
<s:TitleWindow xmlns:fx="http://ns.adobe.com/mxml/2009"
               xmlns:s="library://ns.adobe.com/flex/spark"
               xmlns:mx="library://ns.adobe.com/flex/mx"
               title="Store Information"
               creationComplete="init()">
    <s:layout>
        <s:VerticalLayout horizontalAlign="center"/>
    </s:layout>
    <fx:Script>
        <![CDATA[
        import com.adobe.cairngorm.control.CairngormEventDispatcher;

        import mx.managers.PopUpManager;

        import org.ow2.kerneos.modules.store.event.AddOrUpdateStoreEvent;
        import org.ow2.kerneos.modules.store.event.GetOrDeleteStoreEvent;

        import org.ow2.kerneos.modules.store.vo.StoreVO;

        public var temporalStore : StoreVO = null;

        [Bindable]
        private var nameStore : String = "";
        [Bindable]
        private var urlStore : String = "";
        [Bindable]
        private var descriptionStore : String = "";


        private function init():void {
            if (temporalStore != null) {
                nameStore = temporalStore.name;
                urlStore = temporalStore.url;
                descriptionStore = temporalStore.description;
            }
        }

        // Event handler for the OK button.
        private function addOrEditStore():void {
            var addStore:Boolean = false;
            if (temporalStore == null) {
                temporalStore = new StoreVO();
                addStore = true;
            }

            temporalStore.name = storeName.text;
            temporalStore.url = storeUrl.text;
            temporalStore.description = storeDescription.text;

            if (addStore) {
                var add_store_event:AddOrUpdateStoreEvent = new AddOrUpdateStoreEvent(AddOrUpdateStoreEvent.ADD_STORE);
                add_store_event.store = temporalStore;
                CairngormEventDispatcher.getInstance().dispatchEvent(add_store_event);
            } else {
                var update_store_event:AddOrUpdateStoreEvent = new AddOrUpdateStoreEvent(AddOrUpdateStoreEvent.UPDATE_STORE);
                update_store_event.store = temporalStore;
                CairngormEventDispatcher.getInstance().dispatchEvent(update_store_event);
            }

            var get_stores_event:GetOrDeleteStoreEvent = new GetOrDeleteStoreEvent(GetOrDeleteStoreEvent.GET_STORES);
            CairngormEventDispatcher.getInstance().dispatchEvent(get_stores_event);

            PopUpManager.removePopUp(this);
        }


        ]]>
    </fx:Script>

    <s:HGroup paddingTop="10">
        <s:Label text="Name : "/>
        <s:TextInput id="storeName" text="{nameStore}" width="100%"/>
    </s:HGroup>

    <s:HGroup paddingTop="5">
        <s:Label text="URL : "/>
        <s:TextInput id="storeUrl" text="{urlStore}" width="100%"/>
    </s:HGroup>

    <s:HGroup paddingTop="5">
        <s:Label text="Description : "/>
        <s:TextInput id="storeDescription" text="{descriptionStore}" width="100%"/>
    </s:HGroup>

    <s:HGroup horizontalAlign="center" paddingTop="8" paddingBottom="10">
        <s:Button label="OK" click="addOrEditStore();"/>
        <s:Button label="Cancel" click="PopUpManager.removePopUp(this);"/>
    </s:HGroup>
</s:TitleWindow>
